---
title: "PlaneWaveFit: A Python Package for Two-Dimensional Plane-Wave Fitting of Internal Gravity Waves"
date: 2 Feb 2026
tags:
  - python
  - physical-oceanography
authors:
  - name: Youran Li
    affiliation: "1"
affiliations:
  - name: Scripps Institution of Oceanography, University of California San Diego, USA
    index: 1
---

# Summary

Internal tides are internal gravity waves generated by the interaction of barotropic tides with seafloor topography. They are a primary driver of ocean mixing and play a vital role in the global energy budget. In this paper, we introduce **PlaneWaveFit**, an open-source software package with a Python interface that extracts the amplitude, phase, and propagation direction of internal tides from Sea Surface Height (SSH) observations, with uncertainty estimates for both amplitude and phase provided. 

The software implements a two-dimensional plane-wave fitting approach to resolve multiple wave components. It is broadly applicable to data from satellite missions, such as the Surface Water and Ocean Topography (SWOT) mission, numerical ocean model outputs, and synthetic datasets. It also provides built-in access to precomputed internal tide parameters derived from the climatology in the World Ocean Atlas dataset. These parameters specifically target the dominant mode-1 $M_2$ internal tide and include the necessary conversion ratios to calculate depth-integrated energy and energy flux directly from the fitted surface amplitudes.


# Statement of need

Commonly used packages like `UTide` or `T_TIDE` are designed for temporal harmonic analysis at fixed locations. While effective for tide gauge records, they do not resolve the spatial propagation or directionality of internal tides. PlaneWaveFit addresses this limitation by implementing a two-dimensional fitting approach that extracts $M_2$ internal tides that are both spatially and temporally coherent. 


# State of the field

PlaneWaveFit is designed to integrate with existing tools commonly used in internal tide analysis, such as Temporal harmonic analysis packages such as `UTide` and `T_TIDE` remain appropriate for point-based observations, while PlaneWaveFit extends analysis to two-dimensional satellite swath data by explicitly resolving spatial coherence and propagation.



Additionally, the package provides 

PlaneWaveFit also complements vertical mode solvers such as `dynmodes`. While `dynmodes` provides theoretical vertical mode structures and eigenspeeds from stratification profiles, it does not fit these modes to observations. **PlaneWaveFit** bridges this gap by using precomputed modal properties to physically constrain the fitting of surface he

The package also complements vertical mode solvers such as `dynmodes`, which computes theoretical vertical mode structures and eigenspeeds from stratification profiles. PlaneWaveFit further computes conversion factors to link these vertical modes to surface observations

uses precomputed modal properties to constrain the fitting of surface height anomalies, enabling physically consistent application of vertical mode theory to satellite altimetry data.


# Software design


1.  **Parameter Lookup**: This notebook provides an example to access global internal tide parameters achived on Zenodo. These parameters were generated using `dynmodes` based on the World Ocean Atlas 2023 (WOA23) climatology. While `dynmodes` provides theoretical vertical mode structures and eigenspeeds from stratification profiles, this dataset provides additional conversion factors to link these vertical modes to surface observations. Once fitted amp is get, ... can be calculated. allowing users to retrieve depth integrated energy estimates without performing vertical integration themselves.

2.  **Plane-Wave Fitting**: Internal tide parameters (amplitude $A_m$, phase $\phi_m$, and direction $\theta_m$) are determined by fitting plane waves to SSHA (Equation \ref{eq:multiwave_superposition}). At a given tidal frequency, multiple internal tides may exist at a single site; therefore, the wave field is represented as a superposition of multiple components
    
    $$\eta(x, y, t) = \sum_{m=1}^{N} A_m \cos(k_{x,m} x + k_{y,m} y - \omega t - \phi_m)$$
    
    where $k$ and omega is ... and need to be pre-determined. The solver uses a linear least-squares approach (`numpy.linalg.lstsq`), which is robust and allows for the simultaneous estimation of multiple wave components (e.g., $M_2$, $S_2$, $K_1$) and their associated uncertainties.

3. Uncertainty Quantification
A critical feature of **PlaneWaveFit** is the rigorous quantification of uncertainty. The software computes the covariance matrix of the fitted coefficients to derive standard errors for both amplitude and phase. This capability is essential for distinguishing weak tidal signals from the energetic mesoscale eddy field, a common challenge in altimetry data.

# Research impact statement

 Evidence of realized impact (publications, external use, integrations) or credible near-term significance (benchmarks, reproducible materials, community-readiness signals). The evidence should be compelling and specific, not aspirational.

It has been applied to map internal tides .
 
**PlaneWaveFit** has been successfully applied to map coherent mode-1 $M_2$ internal tides across the Southern Ocean using daily-repeat SWOT Calibration/Validation data [@Li2024]. It has demonstrated the ability to resolve tidal beams in highly energetic regions like the Southwest Indian Ridge and Drake Passage. Evidence of its impact includes the detection of phase curvature consistent with tidal refraction by ocean frontsâ€”a signal often missed by conventional altimetry. By providing a reproducible framework, the package enables researchers to quantify tide-eddy interactions and energy dissipation across various observational and model-based platforms.

# Research impact statement


# AI usage disclosure


# Acknowledgements


# References
